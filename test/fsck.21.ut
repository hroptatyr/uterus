## -*- shell-script -*-

TOOL=ute
INFILE="${srcdir}/fsck.17.ref.leute"
OUTFILE=$(mktemp "/tmp/tmp.XXXXXXXX")
COMMENT="testing ex situ decompression of compressed file"
CMDFILE=$(mktemp "/tmp/tmp.XXXXXXXX")

endian()
{
	ind=$(echo -n I | od -to2 | head -n1 | cut -f2 -d" " | cut -c6)
	if test "${ind}" = "0"; then
		echo "big"
	elif test "${ind}" = "1"; then
		echo "little"
	else
		echo "unknown"
	fi
}

if test "$(endian)" = "big"; then
	INFILE="${srcdir}/fsck.17.ref.beute"
	REFFILE=$(mktemp "/tmp/tmp.XXXXXXXX")
else
	INFILE="${srcdir}/fsck.17.ref.leute"
	REFFILE="${srcdir}/mux.7.ref.ute"
fi

cat <<EOF > "${CMDFILE}"
if test "$(endian)" = "big"; then
	"\${TOOL}" fsck --big-endian "${srcdir}/mux.7.ref.ute" -o '${REFFILE}'
fi
"\${TOOL}" fsck --decompress -o '${OUTFILE}' '${INFILE}'
EOF

## fsck.21.ut ends here
