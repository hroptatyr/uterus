## -*- shell-script -*-

TOOL=ute
INFILE="${srcdir}/mux.h.dukas.bi5"
OUTFILE="testload.ute"
CMDFILE=$(mktemp "/tmp/tmp.XXXXXXXX")

endian()
{
	ind=$(echo -n I | od -to2 | head -n1 | cut -f2 -d" " | cut -c6)
	if test "${ind}" = "0"; then
		echo "big"
	elif test "${ind}" = "1"; then
		echo "little"
	else
		echo "unknown"
	fi
}

cat <<EOF > "${CMDFILE}"
TMPIN='${INFILE}'
TMPOUT='${OUTFILE}'
if test "$(endian)" = "big"; then
	TMPIN=\$(mktemp "/tmp/tmp.XXXXXXXX")
	TMPOUT=\$(mktemp "/tmp/tmp.XXXXXXXX")
	"\${TOOL}" fsck --big-endian '${INFILE}' -o "\${TMPIN}"
fi
"\${TOOL}" mux -f dukas --refdate 1328475600 --name 'AUDUSD' "\${TMPIN}" -o "\${TMPOUT}"
if test "$(endian)" = "big"; then
	"\${TOOL}" fsck --little-endian "\${TMPOUT}" -o '${OUTFILE}'
	rm -f -- "\${TMPIN}" "\${TMPOUT}"
fi
EOF

## STDIN

## STDOUT

## outfile reference
REFFILE="mux.13.ref.ute"

## mux.13.ut ends here
